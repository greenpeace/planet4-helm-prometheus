---
additionalPrometheusRulesMap:
  rule-name:
    groups:
      - name: p4_websites
        rules:
          - alert: ProbeFailed
            expr: probe_success == 0
            for: 5m
            labels:
              severity: error
            annotations:
              summary: "Probe failed (instance {{ $labels.instance }})"
              description: |-
                Probe failed
                VALUE = {{ $value }}
                LABELS: {{ $labels }}
          - alert: SlowProbe
            expr: avg_over_time(probe_duration_seconds[1m]) > 1
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Slow probe (instance {{ $labels.instance }})"
              description: |-
                Probe took more than 1s to complete
                  VALUE = {{ $value }}
                  LABELS: {{ $labels }}
              observability_url: >-
                https://grafana.greenpeace.org/d/EmUBHUFGk/website-monitoring?from=1616392435040&to=1616394235040&orgId=1
          - alert: HttpStatusCode
            expr: probe_http_status_code <= 199 OR probe_http_status_code >= 400
            for: 5m
            labels:
              severity: error
            annotations:
              summary: "HTTP Status Code (instance {{ $labels.instance }})"
              description: |-
                HTTP status code is not 200-399
                  VALUE = {{ $value }}
                  LABELS: {{ $labels }}
              observability_url: >-
                https://grafana.greenpeace.org/d/EmUBHUFGk/website-monitoring?from=1616392435040&to=1616394235040&orgId=1
          - alert: HttpSlowRequests
            expr: avg_over_time(probe_http_duration_seconds[1m]) > 1
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "HTTP slow requests (instance {{ $labels.instance }})"
              description: |-
                HTTP request took more than 1s
                  VALUE = {{ $value }}
                  LABELS: {{ $labels }}
              observability_url: >-
                https://grafana.greenpeace.org/d/EmUBHUFGk/website-monitoring?from=1616392435040&to=1616394235040&orgId=1
